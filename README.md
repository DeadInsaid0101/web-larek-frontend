https://github.com/DeadInsaid0101/web-larek-frontend

# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

Архитектура проекта: MVP (Model-View-Presenter).
Архитектура MVP чётко разделяет данные, визуальный слой и логику взаимодействия.


Классы представления:

Класс Component<T> - Абстрактный базовый класс, от которого наследуются все визуальные компоненты. Предоставляет общие методы и структуру для работы с DOM. Используется обобщённый тип, представляющий структуру данных, которую может отобразить компонент.

Конструктор:
 - container: HTMLElement - принимает на вход DOM-элемент, в котором будет рендериться контент. 

Поля:
 - container:	HTMLElement -	Контейнер DOM-элемента.

Методы:
 - toggleClass(element: HTMLElement, className: string, state: boolean): void - переключает CSS-класс у элемента. Используется для управления отображением или состоянием.
 - setText(element: HTMLElement, value: unknown): void - устанавливает текстовое содержимое элемента.
 - setImage(element: HTMLImageElement, src: string, alt: string): void - устанавливает атрибуты изображения.
 - setDisabled(element: HTMLElement, state: boolean): void - устанавливает или снимает атрибут disabled у элемента формы.
 - render(data: Partial<T>): HTMLElement - применяет переданные данные или их часть к экземпляру компонента. Используется для обновления визуального состояния.



Класс Modal — управляет отображением модального окна на странице. Обеспечивает открытие, закрытие и динамическую подмену содержимого модального окна, независимо от типа отображаемого контента. Наследуется от базового класса Component<ModalData>.

Конструктор:
 - container: HTMLElement — DOM-элемент модального окна, в котором происходит рендеринг.

Поля:
 - modalElement: HTMLElement — элемент модального окна в DOM.
 - containerElement: HTMLElement — внутренний контейнер для вставки конкретного содержимого.
 - closeButton: HTMLElement — кнопка закрытия модального окна.
 - isActive: boolean — флаг, указывающий, открыто ли модальное окно.

Методы:
 - open(): void — отображает модальное окно.
 - close(): void — скрывает модальное окно и очищает содержимое контейнера.
 - render(content: HTMLElement): HTMLElement — обновляет содержимое модального окна, вставляя переданный DOM-элемент в контейнер и возвращает контейнер.



Класс Basket — класс, отвечающий за отображение содержимого корзины. Он наследуется от базового класса Component<IProductItem[]>, что позволяет ему получать массив товаров и отрисовывать их в DOM. Он отображает данные, которые передаются в него из модели через презентер.

Конструктор:
 - container: HTMLElement — DOM-элемент, в который будет рендериться содержимое корзины.

Поля:
 - container: HTMLElement — контейнер для отображения элементов корзины.

Методы:
 - render(data: IProductItem[]): HTMLElement - отображает список товаров в корзине.
 - setEmptyMessage(message: string): void - показывает сообщение, если корзина пуста.
 - setTotal(total: string | number): void - обновляет информацию об общей сумме заказа.
 - setRemoveHandler(handler: (id: string) => void): void - у - станавливает обработчики кнопок «Удалить» для каждого товара.



Класс Form - отвечает за отображение и управление формой оформления заказа. Он отображает поля формы, передаёт их значения в презентер и отображает ошибки валидации. Наследуется от Component<IOrder>.

Конструктор:
 - container: HTMLFormElement — DOM-элемент формы, в котором отображаются поля ввода и кнопка отправки.

Поля:
 - container: HTMLFormElement — DOM-элемент формы.
 - submitButton: HTMLButtonElement — кнопка отправки формы.
 - inputs: Record<keyof IOrder, HTMLInputElement> — все поля формы.

Методы:
 - render(data?: Partial<IOrder>): HTMLElement - отображает значения полей формы.
 - setSubmitHandler(handler: () => void): void - устанавливает обработчик события отправки формы.
 - getFormData(): IOrderForm - считывает данные из полей формы.
 - clear(): void - очищает все поля формы.
 - setDisabled(state: boolean): void - включает или отключает все поля формы и кнопку отправки.
 - validate(): FormErrors — проверяет валидность введённых данных в полях формы.



Класс Success - отвечает за отображение финального сообщения после успешного оформления заказа. Показывает пользователю сумму покупки.

Конструктор:
 - container: HTMLElement — DOM-элемент, в который будет рендериться контент.

Поля:
 - container: HTMLElement — DOM-элемент.

Методы:
 - render(data: { total: number }): HTMLElement - отображает в контейнере сообщение с итоговой суммой покупки.



Класс Page - управляет визуальным представлением основной страницы приложения. Он отвечает за отображение корзины и каталога товаров. Также обрабатывает взаимодействие с корзиной через события.

Конструктор:
 - container: HTMLElement — DOM-элемент, в котором рендерится страница.
 - events: IEvents — объект для работы с событиями.

Поля:
 - counter: HTMLElement — элемент для отображения количества товаров в корзине.
 - catalog: HTMLElement — контейнер для каталога товаров.
 - wrapper: HTMLElement — обёртка всей страницы.
 - basket: HTMLElement — элемент корзины, открывается через событие basket:open.

Методы:
set counter: number — устанавливает значение счётчика товаров в корзине.
set catalog: HTMLElement[] — обновляет содержимое каталога.
locked: boolean — блокирует или разблокирует страницу.



Класс Card - представляет визуальный компонент карточки товара. Он отвечает за отображение информации о товаре. Наследуется от базового компонента Component<IProductItem>.

Конструктор:
 - container: HTMLElement — DOM-элемент карточки товара.
 - events: IEvents — объект с обработчиком событий.

Поля:
 - title: HTMLElement — элемент для отображения названия товара.
 - category: HTMLElement — элемент для отображения категории товара.
 - image: HTMLImageElement — изображение товара.
 - price: HTMLElement — элемент для отображения цены.

Методы:
 - set title(value: string): void — устанавливает текст заголовка товара.
 - set category(value: string): void — устанавливает категорию товара и соответствующий CSS-модификатор класса.
 - set image(value: string): void — устанавливает источник и альтернативный текст изображения.
 - set price(value: string): void — устанавливает цену товара или выводит "Бесценно", если значение равно null.



Класс Order — компонент формы оформления заказа. Наследуется от класса Form. Отвечает за визуальное отображение и обработку событий, связанных с оформлением заказа.

Конструктор:
 - container: HTMLFormElement — HTML-форма, в которую встроен компонент.
 - events: IEvents — экземпляр объекта событий.

Поля:
 - buttons: HTMLButtonElement[] — коллекция кнопок выбора способа оплаты.

Методы:
set payment — устанавливает активное состояние для выбранной кнопки оплаты. Генерирует событие 'payment:change', передавая нажатую кнопку.
set address — устанавливает значение в поле адреса доставки.



Класс Contacts - компонент формы для ввода контактной информации покупателя. Является наследником класса Form. Вызывает событие contacts:submit для отправки формы.

Конструктор:
 - container — DOM-элемент формы.
 - events —  экземпляр объекта событий.

Методы:
 - set phone(value: string): void — устанавливает значение поля phone в форме.
 - set email(value: string): void — устанавливает значение поля email в форме.




Модель:

Класс Model<T> - абстрактный класс модели, который служит для хранения данных и управления событиями изменения состояния приложения. Использует обобщённый тип T для типизации данных модели.

Конструктор:
 - data: Partial<T>, events: IEvents — принимает объект данных и объект событий.

Поля:
 - events: IEvents — объект для управления событиями.

Методы:
 - emitChanges(event: string, data: object): void — устанавливает событие в EventEmitter.



Класс AppData - отвечает за модель приложения. Управляет данными каталога, корзины, заказа, форм и состояния предварительного просмотра. Используется в архитектуре MVP как модель, независимая от визуальной части. Наследуется от базового класса Model<IAppDataState> и взаимодействует с остальной системой через события.

Поля:
 - catalog: IProductItem[] — список товаров.
 - id: string — идентификатор товара.
 - basket: IProductItem[] — массив товаров, добавленных в корзину.
 - order: IOrder — данные текущего заказа.

Методы:
 - setCatalog(items: IProductItem[]): void - преобразует полученный с сервера каталог в объекты и сохраняет в поле catalog. Генерирует событие items:changed.
 - setPreview(item: IProductItem): void - устанавливает выбранный товар для предварительного просмотра и генерирует событие preview:changed.
 - setProductToBasket(item: IProductItem): void - добавляет товар в массив корзины.
 - removeProductToBasket(item: IProductItem): void - удаляет товар из массива корзины.
 - clearBasket(): void - очищает корзину.
 - get basket(): IProductItem[] - возвращает содержимое корзины.
 - getTotal(): number - возвращает сумму всех товаров в заказе.
 - get statusBasket(): boolean - возвращает true, если корзина пуста.
 - set total(value: number): void - устанавливает итоговую сумму заказа.
 - validateOrder(): boolean - валидирует адрес доставки. Генерирует событие formErrors:change.
 - validateContacts(): boolean - валидирует email и телефон. Возвращает true, если ошибок нет. Генерирует событие formErrors:change.



Представитель:

Класс AppPresenter - отвечает за координацию работы модели и представлений. Обрабатывает пользовательские события, обновляет модель, и обновляет представление на основе изменений в модели.

Конструктор:
 - model: AppData — экземпляр модели приложения, содержащий все данные.
 - views: { ... } — объект со всеми компонентами представления.
 - events: IEvents — объект для прослушивания и генерации событий.

Методы:
 - init() - инициализирует начальное состояние приложения.
 - handleProductClick(id: string) - получает товар по id из модели.
 - handleAddToBasket(id: string) - добавляет товар в корзину и обновляет счётчик товаров.
 - handleRemoveFromBasket(id: string) - удаляет товар из корзины.
 - handleOrderSubmit() - валидирует форму адреса, осуществляет переходит к форме контактов.
 - handleContactsSubmit() - валидирует контактные данные, рассчитывает сумму, очищает корзину и показывает сообщение об успехе.

Обработка событий:
 - preview:changed → вызывает открытие модального окна и отображает карточку товара.
 - items:changed → перерисовывает каталог товаров на главной странице.
 - formErrors:change → передаёт ошибки валидации в компонент формы.
 - order:ready → активирует кнопку оформления заказа.
 - basket:open → открывает модальное окно с корзиной.
 - payment:change → обновляет выбранный способ оплаты в модели.